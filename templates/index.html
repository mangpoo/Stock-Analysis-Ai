<!DOCTYPE html>
<html lang="ko">
<script>
    window.addEventListener("message", (event) => {
    console.log(event.data)
    if (event.data?.type === "theme") {
        const isDark = event.data.dark;

        document.documentElement.style.setProperty('--bg-color', isDark ? '#121212' : '#ffffff');
        document.documentElement.style.setProperty('--text-color', isDark ? '#e0e0e0' : '#000000');
        document.documentElement.style.setProperty('--log-bg', isDark ? '#1e1e1e' : '#f5f5f5');
        document.documentElement.style.setProperty('--border-color', isDark ? '#333' : '#ddd');
    }
});

</script>
<head>
    <meta charset="UTF-8">
    <title>워커 {{worker_id}} 로그</title>
    <style>
        :root {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --log-bg: #1e1e1e;
            --border-color: #333;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 20px;
        }

        #log-container {
            background-color: var(--log-bg);
            color: var(--text-color);
            padding: 15px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
            white-space: pre-wrap;
            font-family: monospace;
        }

        h3 {
            color: var(--text-color);
        }
    </style>
</head>
<body>
    <h3>워커 {{worker_id}} 실시간 로그</h3>
    <div id="log-container">...</div>

    <script>
        const logContainer = document.getElementById('log-container');
        let lastLog = '';

        function fetchLogs() {
            fetch('/get-logs')
                .then(response => response.json())
                .then(data => {
                    if (data.log !== lastLog) {
                        lastLog = data.log;
                        logContainer.innerText = data.log;
                        logContainer.scrollTop = logContainer.scrollHeight;
                    }
                })
                .catch(error => {
                    logContainer.innerText = '로그 가져오기 실패: ' + error;
                })
                .finally(() => {
                    setTimeout(fetchLogs, 100);
                });
        }

        fetchLogs();
    </script>
</body>
</html>
